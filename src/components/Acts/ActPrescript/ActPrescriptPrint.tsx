import React from 'react';
import './ActPrescriptPrint.css';
import { PrintRow } from '../Forms/Forms';

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—á–∞—Ç–Ω–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è
interface ActPrescriptData {
  id?: string;
  prescription_number: string;
  prescription_date: string;
  violator_name: string;
  violator_position: string;
  violator_address: string;
  violation_description: string;
  violation_date: string;
  violation_time: string;
  violation_location: string;
  legal_basis: string;
  elimination_period: string;
  elimination_date: string;
  inspector_name: string;
  inspector_position: string;
  inspector_signature_date: string;
  organization_head_name: string;
  organization_head_position: string;
  gas_equipment_type: string;
  apartment: string;
  house: string;
  street: string;
  subscriber_name: string;
  witness_name?: string;
  witness_position?: string;
  additional_notes?: string;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å props
interface ActPrescriptPrintProps {
  mode: 'print';
  data: ActPrescriptData;
  onClose: () => void;
}

const ActPrescriptPrint: React.FC<ActPrescriptPrintProps> = ({
  mode,
  data,
  onClose
}) => {
  // –§—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  const formatDateForDisplay = (dateStr: string) => {
    if (!dateStr) return { day: '_____', month: '__________________', year: '___' };
    const date = new Date(dateStr);
    const months = [
      '—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è',
      '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'
    ];
    return {
      day: date.getDate().toString(),
      month: months[date.getMonth()],
      year: date.getFullYear().toString().slice(-2)
    };
  };

  const formatTimeForDisplay = (timeStr: string) => {
    if (!timeStr) return { hours: '_____', minutes: '______' };
    const [hours, minutes] = timeStr.split(':');
    return { hours, minutes };
  };

  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  const prescriptionDateFormatted = formatDateForDisplay(data.prescription_date);
  const violationDateFormatted = formatDateForDisplay(data.violation_date);
  const violationTimeFormatted = formatTimeForDisplay(data.violation_time);
  const eliminationDateFormatted = formatDateForDisplay(data.elimination_date);
  const signatureDateFormatted = formatDateForDisplay(data.inspector_signature_date);

  const handlePrint = () => {
    window.print();
  };

  // –†–µ–∂–∏–º –ø–µ—á–∞—Ç–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—á–∞—Ç–Ω—É—é —Ñ–æ—Ä–º—É
  if (mode === 'print') {
    return (
      <div className="prescript-form-container">
        {/* –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π */}
        <div className="prescript-print-actions prescript-no-print">
          <button onClick={handlePrint} className="prescript-btn prescript-btn-primary">
            üñ®Ô∏è –ü–µ—á–∞—Ç—å
          </button>
          <button onClick={onClose} className="prescript-btn prescript-btn-secondary">
            ‚úï –ó–∞–∫—Ä—ã—Ç—å
          </button>
        </div>

        {/* –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–µ—á–∞—Ç–∏ */}
        <div className="prescript-print-content-scrollable">
          <div className="prescript-print-content">
            {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ */}
              <div className="act-document-header">
                <div className="act-logo-section">
                  <img src="USD.png" alt="USD" className='h-4'/>
                </div>
              </div>
              <div className="prescript-header-info">
                <div className="prescript-department">
                  –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ<br/>
                  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Å–±—ã—Ç–æ–≤–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>
                  677005, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è), –≥.–Ø–∫—É—Ç—Å–∫, —É–ª.–ü.–ê–ª–µ–∫—Å–µ–µ–≤–∞, 64 –ë
                </div>
              </div>

            {/* –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ */}
            <div className="prescript-document-content">
              <div className="prescript-document-title">
                <h1>–ü–†–ï–î–ü–ò–°–ê–ù–ò–ï ‚Ññ{data.prescription_number || '______'}</h1>
                <h2>–∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–∞–∑–æ–º –≤ –±—ã—Ç—É</h2>
              </div>

              <div className='flex fl-space'>
                  <div></div>
                  <div>
                    {prescriptionDateFormatted.day + ' ' + prescriptionDateFormatted.month + ' 20' + prescriptionDateFormatted.year + '–≥.' }
                  </div>
              </div>

              <div className="prescript-main-content">
                <PrintRow 
                  prefix={'–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'} 
                  data={data.violator_name || ''}
                />
                <div className="prescript-field-description">—Ñ.–∏.–æ., –¥–æ–ª–∂–Ω–æ—Å—Ç—å</div>

                <PrintRow 
                  prefix={'–≤ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–±–æ–Ω–µ–Ω—Ç–∞:'} 
                  data={data.subscriber_name || ''}
                />
                <div className="prescript-field-description">—Ñ.–∏.–æ. (–ø–æ–ª–Ω.)</div>

                <PrintRow 
                  prefix={'—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–µ–≥–æ –ª–∏—á–Ω–æ—Å—Ç—å:'} 
                  data={''}
                />

                <PrintRow 
                  prefix={'–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è –∞–±–æ–Ω–µ–Ω—Ç–∞:'} 
                  data={''}
                />
                <div className="prescript-field-description">—Ñ.–∏.–æ. (–ø–æ–ª–Ω.)</div>

                <PrintRow 
                  prefix={'—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–µ–≥–æ –ª–∏—á–Ω–æ—Å—Ç—å:'} 
                  data={''}
                />

                <div className="prescript-violation-section">
                  <PrintRow 
                    prefix={'—Å–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç –æ —Ç–æ–º, —á—Ç–æ ¬´'} 
                    data={violationDateFormatted.day}
                  />
                  <PrintRow prefix={''} data={violationDateFormatted.month} />
                  <PrintRow prefix={'202'} data={violationDateFormatted.year + '–≥.'} />
                  <PrintRow prefix={'–≤'} data={violationTimeFormatted.hours} />
                  <PrintRow prefix={'—á–∞—Å.'} data={violationTimeFormatted.minutes + ' –º–∏–Ω.'} />
                  
                  <div className="prescript-violation-text">
                    <PrintRow prefix={'–≤—ã—è–≤–ª–µ–Ω–æ:'} data={data.violation_description || ''} />
                  </div>
                </div>

                <div className="prescript-location-section">
                  <PrintRow 
                    prefix={'–ø–æ –∞–¥—Ä–µ—Å—É: –∫–≤.'} 
                    data={data.apartment || '__'} 
                  />
                  <PrintRow prefix={'–¥–æ–º'} data={data.house || '__'} />
                  <PrintRow prefix={'—É–ª.'} data={data.street || '______________'} />
                </div>

                <div className="prescript-legal-section">
                  <PrintRow 
                    prefix={'–°–æ–≥–ª–∞—Å–Ω–æ –ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –†–§ –æ—Ç 21 –∏—é–ª—è 2008–≥. ‚Ññ549 ¬´–û –ø–æ—Ä—è–¥–∫–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –≥–∞–∑–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–º–º—É–Ω–∞–ª—å–Ω–æ-–±—ã—Ç–æ–≤—ã—Ö –Ω—É–∂–¥ –≥—Ä–∞–∂–¥–∞–Ω¬ª'} 
                    data={''}
                  />
                  
                  <div className="prescript-order-text">
                    <PrintRow 
                      prefix={'–ü–†–ï–î–ü–ò–°–´–í–ê–Æ:'} 
                      data={data.legal_basis || ''}
                    />
                  </div>

                  <PrintRow 
                    prefix={'–°—Ä–æ–∫ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–æ ¬´'} 
                    data={eliminationDateFormatted.day}
                  />
                  <PrintRow prefix={''} data={eliminationDateFormatted.month} />
                  <PrintRow prefix={'202'} data={eliminationDateFormatted.year + '–≥.'} />
                </div>

                <div className="prescript-equipment-section">
                  <div className="prescript-subsection-title">–ø–æ–∫–∞–∑–∞–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤:</div>
                  
                  <PrintRow prefix={'1. —Ç–∏–ø: –ì_______ ‚Ññ'} data={''} />
                  <PrintRow prefix={'—Å–æ—Å—Ç–∞–≤–ª—è—é—Ç: ___'} data={'–º¬≥ –ø–ª–æ–º–±–∞____'} />
                  <PrintRow prefix={'—Ü–≤–µ—Ç'} data={''} />
                  
                  <div className="prescript-field-description">–≥–∞–∑–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:</div>
                  
                  <div className="prescript-measurement-text">
                    –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –∑–∞–º–µ—Ä –æ—Ç–∞–ø–ª–∏–≤–∞–µ–º—ã—Ö –ø–ª–æ—â–∞–¥–µ–π:<br/>
                    –∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å ____________–º¬≤ –Ω–µ–∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å ________________–º¬≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ _______ —á–µ–ª.
                  </div>

                  <PrintRow prefix={'2. —Ç–∏–ø: –ì_______ ‚Ññ'} data={''} />
                  <PrintRow prefix={'—Å–æ—Å—Ç–∞–≤–ª—è—é—Ç: ___'} data={'–º¬≥ –ø–ª–æ–º–±–∞____'} />
                  <PrintRow prefix={'—Ü–≤–µ—Ç'} data={''} />
                  
                  <div className="prescript-field-description">–≥–∞–∑–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:</div>
                  
                  <div className="prescript-measurement-text">
                    –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –∑–∞–º–µ—Ä –æ—Ç–∞–ø–ª–∏–≤–∞–µ–º—ã—Ö –ø–ª–æ—â–∞–¥–µ–π:<br/>
                    –∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å ____________–º¬≤ –Ω–µ–∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å ________________–º¬≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ _______ —á–µ–ª.
                  </div>

                  <PrintRow prefix={'–û—Å–æ–±–æ–µ –º–Ω–µ–Ω–∏–µ –∞–±–æ–Ω–µ–Ω—Ç–∞:'} data={''} />
                  <PrintRow prefix={'–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:'} data={data.additional_notes || ''} />
                </div>

                <div className="prescript-signatures-section">
                  <div className="prescript-signatures-title">–ü–æ–¥–ø–∏—Å–∏ —Å—Ç–æ—Ä–æ–Ω:</div>

                  <PrintRow 
                    prefix={'–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'} 
                    data={''}
                  />
                  <div className="prescript-field-description">–¥–æ–ª–∂–Ω–æ—Å—Ç—å, —Ñ.–∏.–æ.</div>

                  <PrintRow prefix={'–∞–±–æ–Ω–µ–Ω—Ç'} data={''} />

                  <PrintRow 
                    prefix={'–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –∞–±–æ–Ω–µ–Ω—Ç–∞'} 
                    data={''}
                  />

                  <PrintRow 
                    prefix={'–ü—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –∞–∫—Ç–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª: –§.–ò.–û.:'} 
                    data={''}
                  />
                  <div className="prescript-field-description">—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–µ–≥–æ –ª–∏—á–Ω–æ—Å—Ç—å</div>
                </div>

                <div className="prescript-note-section">
                  <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ê–ö–¢ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö, –æ–¥–∏–Ω –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–¥–∞—ë—Ç—Å—è –Ω–∞ —Ä—É–∫–∏ –∞–±–æ–Ω–µ–Ω—Ç—É, 
                  –¥—Ä—É–≥–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –≥–∞–∑–∞.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  // –í –¥—Ä—É–≥–∏—Ö —Ä–µ–∂–∏–º–∞—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null
  return null;
};

export default ActPrescriptPrint;